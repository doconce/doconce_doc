<!DOCTYPE html>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="On Schemes for Exponential Decay">

<title>On Schemes for Exponential Decay</title>







<!-- deck.js: https://github.com/imakewebthings/deck.js -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=1024, user-scalable=no">

<!-- Required stylesheet -->
<link rel="stylesheet" href="deck.js/core/deck.core.css">

<!-- Extension CSS files go here. Remove or add as needed.
deck.goto: Adds a shortcut key to jump to any slide number.
Hit g, type in the slide number, and hit enter.

deck.hash: Enables internal linking within slides, deep
linking to individual slides, and updates the address bar and
a permalink anchor with each slide change.

deck.menu: Adds a menu view, letting you see all slides in a grid.
Hit m to toggle to menu view, continue navigating your deck,
and hit m to return to normal view. Touch devices can double-tap
the deck to switch between views.

deck.navigation: Adds clickable left and right buttons for the
less keyboard inclined.

deck.status: Adds a page number indicator. (current/total).

deck.scale: Scales each slide to fit within the deck container
using CSS Transforms for those browsers that support them.

deck.pointer: Turn mouse into laser pointer (toggle with p).
(Requires https://github.com/mikeharris100/deck.pointer.js)
-->

<link rel="stylesheet" href="deck.js/extensions/menu/deck.menu.css">
<link rel="stylesheet" href="deck.js/extensions/navigation/deck.navigation.css">
<link rel="stylesheet" href="deck.js/extensions/scale/deck.scale.css">
<link rel="stylesheet" href="deck.js/extensions/pointer/deck.pointer.css">
<link rel="stylesheet" href="deck.js/extensions/notes/deck.notes.css">
<!--
<link rel="stylesheet" href="deck.js/extensions/goto/deck.goto.css">
<link rel="stylesheet" href="deck.js/extensions/hash/deck.hash.css">
<link rel="stylesheet" href="deck.js/extensions/status/deck.status.css">
-->

<!-- Style theme. More available in themes/style/ or create your own. -->
<link rel="stylesheet" href="deck.js/themes/style/web-2.0.css">

<!--
<link rel="stylesheet" href="deck.js/themes/style/neon.css">
<link rel="stylesheet" href="deck.js/themes/style/swiss.css">
<link rel="stylesheet" href="deck.js/themes/style/web-2.0.css">

git clone git://github.com/duijf/mnml.git
<link rel="stylesheet" href="deck.js/themes/style/mnml.css">

git://github.com/groovecoder/deckjs-theme-mozilla.git
<link rel="stylesheet" href="deck.js/themes/style/sandstone.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.aurora.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.dark.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.default.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.firefox.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.light.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.mdn.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.nightly.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.cbc.css">

git://github.com/barraq/deck.ext.js.git
<link rel="stylesheet" href="deck.js/themes/style/beamer.css">
-->

<!--
Transition theme. More available in /themes/transition/ or create your own. -->
<!--
<link rel="stylesheet" href="deck.js/themes/transition/horizontal-slide.css">
<link rel="stylesheet" href="deck.js/themes/transition/fade.css">
<link rel="stylesheet" href="deck.js/themes/transition/vertical-slide.css">
<link rel="stylesheet" href="deck.js/themes/transition/horizontal-slide.css">
-->

<!-- Required Modernizr file -->
<script src="deck.js/modernizr.custom.js"></script>

<style type="text/css">
/* Override h1, h2, ... styles */
h1 { font-size: 2.8em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.4em; }
h4 { font-size: 1.3em; }
h1, h2, h3, h4 { font-weight: bold; line-height: 1.2; }
body { overflow: auto; } /* vertical scrolling */

hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.slide .alert-text-small   { font-size: 80%;  }
.slide .alert-text-large   { font-size: 130%; }
.slide .alert-text-normal  { font-size: 90%;  }
.slide .alert {
     padding:8px 35px 8px 14px; margin-bottom:18px;
     text-shadow:0 1px 0 rgba(255,255,255,0.5);
     border:5px solid #bababa;
       -webkit-border-radius:14px; -moz-border-radius:14px;
     border-radius:14px
     background-position: 10px 10px;
     background-repeat: no-repeat;
     background-size: 38px;
     padding-left: 30px; /* 55px; if icon */
 }
 .slide .alert-block {padding-top:14px; padding-bottom:14px}
 .slide .alert-block > p, .alert-block > ul {margin-bottom:0}
 /*.slide .alert li {margin-top: 1em}*/
 .deck .alert-block p+p {margin-top:5px}
 /*.slide .alert-notice { background-image: url(http://hplgit.github.io/doconce/bundled/html_images//small_gray_notice.png); }
 .slide .alert-summary  { background-image:url(http://hplgit.github.io/doconce/bundled/html_images//small_gray_summary.png); }
 .slide .alert-warning { background-image: url(http://hplgit.github.io/doconce/bundled/html_images//small_gray_warning.png); }
 .slide .alert-question {background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */

</style>



<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>

<body class="deck-container">

<header>
<!-- Here goes a potential header -->
</header>

<!-- do not use the article tag - it gives strange sizings -->





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    



<section class="slide">
<!-- ------------------- main content ---------------------- -->

<h2 style="text-align: center;">On Schemes for Exponential Decay</h2>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b style="font-weight: bold">Hans Petter Langtangen</b> [1, 2] (<tt>hpl at simula.no</tt>)
</center>

<p>
<!-- institution(s) -->

<center>[1] <b style="font-weight: bold">Center for Biomedical Computing, Simula Research Laboratory</b></center>
<center>[2] <b style="font-weight: bold">Department of Informatics, University of Oslo</b></center>
<br>
<p>
<center><b style="font-weight: bold">Sep 24, 2015</b></center> <!-- date -->
<br>
<p>
<center><p><img src="fig/CN_logo.png" align="bottom" width=300></p></center>

<p>
<!-- Each slide starts with !split and a title inside 5 = on each side -->
<!-- (i.e., DocOnce subsections are used to specify slide titles, -->
<!-- sections are used for parts/sections of the talk to appear in a -->
<!-- table of contents) -->

<p>

<center style="font-size:80%">
<!-- copyright --> &copy; 2015, Hans Petter Langtangen. Released under CC Attribution 4.0 license
</center>
</section>


<section class="slide">

<h2 id="___sec0">Goal </h2>

<p>
The primary goal of this demo talk is to demonstrate how to write
talks with <a href="https://github.com/hplgit/doconce" target="_self">DocOnce</a>
and get them rendered in numerous HTML formats.
<div class="alert alert-block alert-notice alert-text-normal">
<b style="font-weight: bold">Layout.</b>
<p>
This version
utilizes deck slides with the theme <code>web-2.0</code>.
</div>

<p>
<div class="alert alert-block alert-notice alert-text-normal">
<b style="font-weight: bold">Notice.</b>
<p>
Speaker notes show up by
pressing "n".
</div>

<p>
<div class="notes">
<!-- press "n" to activate -->

The talk investigates the accuracy of three finite difference
schemes for the ordinary differential equation \( u'=-au \) with the
aid of numerical experiments. Numerical artifacts are in particular
demonstrated.

</div>
</section>


<section class="slide">

<h1 id="___sec1">Problem setting and methods </h1>
<!-- Short title: Problem -->

<p>
<center><p><img src="fig/method.png" align="bottom" width=600></p></center>
</section>


<section class="slide">

<h2 id="___sec2">We aim to solve the (almost) simplest possible differential equation problem </h2>

<p>

<table border="0">
<tr>
<td class="padding">
<p>&nbsp;<br>
$$
\begin{align}
u'(t) &= -au(t)
\tag{1}\\ 
u(0)  &= I
\tag{2}
\end{align}
$$
<p>&nbsp;<br>

<p>
Here,

<ul>
 <p><li> \( t\in (0,T] \)</li>
 <p><li> \( a \), \( I \), and \( T \) are prescribed parameters</li>
 <p><li> \( u(t) \) is the unknown function</li>
 <p><li> The ODE <a href="#mjx-eqn-1">(1)</a> has the initial condition <a href="#mjx-eqn-2">(2)</a></li>
</ul>
<p>
</td>
<td class="padding">
<center><p><img src="fig/teacher2.jpg" align="bottom" width=250></p></center>
</td>
</tr>
</table>
</section>


<section class="slide">

<h2 id="___sec3">The ODE problem is solved by a finite difference scheme </h2>

<ul>
 <p><li class="slide"> Mesh in time: \( 0= t_0 < t_1 \cdots < t_N=T \)</li>
 <p><li class="slide"> Assume constant \( \Delta t = t_{n}-t_{n-1} \)</li>
 <p><li class="slide"> \( u^n \): numerical approx to the exact solution at \( t_n \)</li>
</ul>
<p>

<p class="slide">

The \( \theta \) rule,

&nbsp;<br>&nbsp;<br>
$$
u^{n+1} = \frac{1 - (1-\theta) a\Delta t}{1 + \theta a\Delta t}u^n,
\quad n=0,1,\ldots,N-1
$$
&nbsp;<br>&nbsp;<br>

contains the <a href="http://en.wikipedia.org/wiki/Forward_Euler_method" target="_self">Forward Euler</a> (\( \theta=0 \)),
the <a href="http://en.wikipedia.org/wiki/Backward_Euler_method" target="_self">Backward Euler</a> (\( \theta=1 \)),
and the <a href="http://en.wikipedia.org/wiki/Crank-Nicolson" target="_self">Crank-Nicolson</a> (\( \theta=0.5 \))
schemes.

</p>
</section>


<section class="slide">

<h2 id="___sec4">The Forward Euler scheme explained </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold"></b>
<p>

<iframe width="640" height="480" src="http://www.youtube.com/embed/PtJrPEIHNJw" frameborder="0" allowfullscreen></iframe>
</div>
</section>


<section class="slide">

<h2 id="___sec5">Implementation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Implementation in a Python function:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "autumn" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span style="color: #0000aa">def</span> <span style="color: #00aa00">solver</span>(I, a, T, dt, theta):
    <span style="color: #aa5500">&quot;&quot;&quot;Solve u&#39;=-a*u, u(0)=I, for t in (0,T]; step: dt.&quot;&quot;&quot;</span>
    dt = <span style="color: #00aaaa">float</span>(dt)           <span style="color: #aaaaaa; font-style: italic"># avoid integer division</span>
    N = <span style="color: #00aaaa">int</span>(<span style="color: #00aaaa">round</span>(T/dt))     <span style="color: #aaaaaa; font-style: italic"># no of time intervals</span>
    T = N*dt                 <span style="color: #aaaaaa; font-style: italic"># adjust T to fit time step dt</span>
    u = zeros(N+<span style="color: #009999">1</span>)           <span style="color: #aaaaaa; font-style: italic"># array of u[n] values</span>
    t = linspace(<span style="color: #009999">0</span>, T, N+<span style="color: #009999">1</span>)  <span style="color: #aaaaaa; font-style: italic"># time mesh</span>

    u[<span style="color: #009999">0</span>] = I                 <span style="color: #aaaaaa; font-style: italic"># assign initial condition</span>
    <span style="color: #0000aa">for</span> n <span style="color: #0000aa">in</span> <span style="color: #00aaaa">range</span>(<span style="color: #009999">0</span>, N):    <span style="color: #aaaaaa; font-style: italic"># n=0,1,...,N-1</span>
        u[n+<span style="color: #009999">1</span>] = (<span style="color: #009999">1</span> - (<span style="color: #009999">1</span>-theta)*a*dt)/(<span style="color: #009999">1</span> + theta*dt*a)*u[n]
    <span style="color: #0000aa">return</span> u, t
</pre></div>

</div>
</section>


<section class="slide">

<h2 id="___sec6">How to use the solver function </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">A complete main program.</b>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "autumn" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span style="color: #aaaaaa; font-style: italic"># Set problem parameters</span>
I = <span style="color: #009999">1.2</span>
a = <span style="color: #009999">0.2</span>
T = <span style="color: #009999">8</span>
dt = <span style="color: #009999">0.25</span>
theta = <span style="color: #009999">0.5</span>

<span style="color: #0000aa">from</span> <span style="color: #00aaaa; text-decoration: underline">solver</span> <span style="color: #0000aa">import</span> solver, exact_solution
u, t = solver(I, a, T, dt, theta)

<span style="color: #0000aa">import</span> <span style="color: #00aaaa; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #0000aa">as</span> <span style="color: #00aaaa; text-decoration: underline">plt</span>
plt.plot(t, u, t, exact_solution)
plt.legend([<span style="color: #aa5500">&#39;numerical&#39;</span>, <span style="color: #aa5500">&#39;exact&#39;</span>])
plt.show()
</pre></div>

</div>
</section>


<section class="slide">

<h1 id="___sec7">Results </h1>

<p>
<center><p><img src="fig/results.jpg" align="bottom" width=600></p></center>
</section>


<section class="slide">

<h2 id="___sec8">The Crank-Nicolson method shows oscillatory behavior for not sufficiently small time steps, while the solution should be monotone </h2>

<p>
<center><p><img src="fig/CN.png" align="bottom" width=600></p></center>
</section>


<section class="slide">

<h2 id="___sec9">The artifacts can be explained by some theory </h2>

<p>

<p class="slide">

Exact solution of the scheme:

&nbsp;<br>&nbsp;<br>
$$ u^n = A^n,\quad A = \frac{1 - (1-\theta) a\Delta t}{1 + \theta a\Delta t}\thinspace .$$
&nbsp;<br>&nbsp;<br>


</p>

<p>
Key results:

<ul>
 <p><li class="slide"> Stability: \( |A| < 1 \)</li>
 <p><li class="slide"> No oscillations: \( A>0 \)</li>
 <p><li class="slide"> \( \Delta t < 1/a \) for Forward Euler (\( \theta=0 \))</li>
 <p><li class="slide"> \( \Delta t < 2/a \) for Crank-Nicolson (\( \theta=1/2 \))</li>
</ul>
<p>

<div class="slide alert alert-block alert-summary alert-text-normal">
<b style="font-weight: bold">Concluding remarks:</b>
<p>
Only the Backward Euler scheme is guaranteed to always give
qualitatively correct results.
</div>
</section>




<footer>
<!-- Here goes a footer -->
</footer>

<!-- Begin extension snippets. Add or remove as needed. -->

<!-- deck.navigation snippet -->
<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<!-- deck.status snippet
<p class="deck-status">
	<span class="deck-status-current"></span>
	/
	<span class="deck-status-total"></span>
</p>
-->

<!-- deck.goto snippet
<form action="." method="get" class="goto-form">
	<label for="goto-slide">Go to slide:</label>
	<input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
	<datalist id="goto-datalist"></datalist>
	<input type="submit" value="Go">
</form>
-->

<!-- deck.hash snippet
<a href="." title="Permalink to this slide" class="deck-permalink">#</a>
-->

<!-- End extension snippets. -->


<!-- Required JS files. -->
<script src="deck.js/jquery.min.js"></script>
<script src="deck.js/core/deck.core.js"></script>

<!-- Extension JS files. Add or remove as needed. -->
<script src="deck.js/core/deck.core.js"></script>
<script src="deck.js/extensions/hash/deck.hash.js"></script>
<script src="deck.js/extensions/menu/deck.menu.js"></script>
<script src="deck.js/extensions/goto/deck.goto.js"></script>
<script src="deck.js/extensions/status/deck.status.js"></script>
<script src="deck.js/extensions/navigation/deck.navigation.js"></script>
<script src="deck.js/extensions/scale/deck.scale.js"></script>
<script src="deck.js/extensions/notes/deck.notes.js"></script>

<!-- From https://github.com/mikeharris100/deck.pointer.js -->
<script src="deck.js/extensions/pointer/deck.pointer.js"></script>

<!-- From https://github.com/stvnwrgs/presenterview
<script type="text/javascript" src="deck.js/extensions/presenterview/deck.presenterview.js"></script> -->

<!-- From https://github.com/nemec/deck.annotate.js
<script type="text/javascript" src="deck.js/extensions/deck.annotate.js/deck.annotate.js"></script>
-->


<!-- Initialize the deck. You can put this in an external file if desired. -->
<script>
	$(function() {
		$.deck('.slide');
	});
</script>


</body>
</html>
